## 第一章

# 利用神经网络识别手写数字

人类的视觉系统是世界奇迹之一。考虑下面的手写数字序列：

<img src="http://neuralnetworksanddeeplearning.com/images/digits.png" style="zoom:30%" />

大多数人毫不费力地将这些数字识别为504192.这种毫不费力是欺骗性的。在我们大脑的每个半球中，人类都有一个主要的视觉皮层，也被称为V1，含有1.4亿个神经元，它们之间有数以百亿计的联系。然而，人类视觉不仅涉及V1，而且包括V2，V3，V4和V5在内的整个视觉皮质系列 - 逐渐进行更复杂的图像处理。我们的头脑中有一台超级计算机，根据数亿年的演变进行调整，并且非常适合了解视觉世界。识别手写数字并不容易。相反，我们人类是惊人的，非常擅长理解我们的眼睛向我们展示的东西。但几乎所有这些工作都是在无意识中完成的。所以我们通常不会意识到我们的视觉系统解决问题有多艰难。

如果您尝试编写计算机程序来识别上述数字，则视觉模式识别的难度就会变得明显。看似容易，然而当我们自己做时，你会发现突然之间这变得非常困难。我们如何识别形状最简单的直觉是 - “一个9在顶部有一个圈，而在右下方有一竖” - 这种结果并不是那么简单地可以在算法上表达。当你试图精确地制定这样的规则时，你很快会迷失在各种例外以及特殊情况之中。而这似乎解决不了什么问题。

神经网络以不同的方式解决问题。这个想法是采取大量的手写数字，称为训练示例，

<img src="http://neuralnetworksanddeeplearning.com/images/mnist_100_digits.png" style="zoom:100%" />

然后开发一个可以从这些例子中学习的系统。换句话说，神经网络使用这些例子来自动推断识别手写数字的规则。此外，通过增加训练示例的数量，神经网络可以了解更多关于手写的内容，从而提高其准确性。所以，虽然我只显示了上面的100个训练数字，但也许我们可以使用数千甚至数百万或数十亿个训练示例来构建更好的手写识别器。

在本章中，我们将编写一个计算机程序，实现一个学习识别手写数字的神经网络。该程序只有74行，并且不使用特殊的神经网络库。但是这个简短的程序能够以超过96％的精度识别数字，无需人工干预。此外，在后面的章节中，我们将开发可以将准确度提高到99％以上的想法。事实上，最好的商业神经网络现在非常好，银行用它来处理支票，并由邮局来识别地址。

我们专注于手写识别，因为它对于一般学习神经网络来说是一个很好的原型问题。作为原型，==它迎来了一个甜蜜点==：它很具有挑战性 - 识别手写数字并不是一件容易的事情 - 但它并不是一个非常复杂的解决方案或者需要巨大的计算能力。此外，这是开发更深入学习等更先进技术的好方法。因此，在整本书中，我们会一再回顾手写识别的问题。在本书后面，我们将讨论这些想法如何应用于计算机视觉中的其他问题，以及语音，自然语言处理和其他领域。

当然，如果本章的要点只是编写一个识别手写数字的电脑程序，那么本章将会更短！但随后，我们将开发许多关于神经网络的关键思想，包括两种重要类型的人工神经元（感知器和S形神经元）和神经网络的标准学习算法，称为随机梯度下降。在整个过程中，我重点解释为什么事情按照他们的方式完成，并且建立你的神经网络直觉。这需要更长时间的讨论，但为了您能获得更深的理解，这是值得的。 到本章结束时，我们将理解深度学习是什么，为什么它很重要。

## 感知器

什么是神经网络？要开始，我将解释一种称为感知器的人造神经元。受到了Warren McCulloch和Walter Pitts早期工作的启发，感知器是在20世纪五六十年代由科学家Frank Rosenblatt开发的。今天，使用其他人造神经元模型更为常见 - 在本书中以及在神经网络上的大量现代工作中，使用的主要神经元模型是一种称为S形神经元的模型。我们马上就会讲到S形神经元。但要理解为什么S形神经元的定义方式是这样，这就得花时间先了解**感知器**。

那么感知器如何工作？一个感知器需要几个二进制输入，$x1$，$x2$，...，并产生一个单一的二进制输出：

<img alt="proceptrons" src="http://neuralnetworksanddeeplearning.com/images/tikz0.png">

在所示的例子中，感知器有三个输入，$x1$，$x2$，$x3$。一般来说，它可以有更多或更少的输入。Rosenblatt提出了一个简单的规则来计算输出。他介绍了*权重*$w1$，$w2$，...，这些实数表示各个输入对输出的重要性。神经元的输出0或1由加权和$\sum_j w_j x_j$是小于还是大于某个阈值决定。就像权重一样，阈值是一个实数，它是神经元的一个参数。把它放在更精确的代数术语中：

$\begin{eqnarray}\mbox{output} & = & \left\{ \begin{array}{ll}0 & \mbox{if } \sum_j w_j x_j \leq \mbox{ threshold} \\1 & \mbox{if } \sum_j w_j x_j > \mbox{ threshold}\end{array} \right.\tag{1}\end{eqnarray}$

这就是感知器如何工作的一切！

这是基本的数学模型。 您可以这样去想感知器，它是一种通过权衡证据来做出决定的设备。 让我举个例子。 这不是一个非常现实的例子，但它很容易理解，我们很快就会得到更实际的例子。 假设周末即将到来，你听说你的城市将会有一场奶酪节。 你喜欢奶酪，并试图决定是否参加这个节日。 您可以通过权衡三个因素来做出决定：

1. 天气好吗？
2. 你的男朋友或女朋友是否想陪你？
3. 节日地点附近公交方便吗？ （你没有车）。

我们可以用相应的二元变量$x1$，$x2$和$x3$来表示这三个因子。 例如，如果天气好，我们有$x1 = 1$，如果天气不好，$x1 = 0$。 同样，如果你的男朋友或女朋友想要去$x2 = 1$，如果没有，$x2 = 0$。 对于$x3$和公交来说同样如此。

现在，假设你超级喜欢奶酪，那么即使你的男朋友或女朋友不感兴趣并且节日地点很难到达，你也很乐意去参加这个音乐节。但是也许你真的厌恶恶劣天气，如果天气不好，你就不可能去参加这个节日。您可以使用感知器来对这种决策进行建模。一种方法是为天气选择一个重量 $w1 = 6$，其他条件选择 $w2 = 2$ 和 $w3 = 2$ 。 $w1$的较大值表示天气对您来说很重要，远远超过您的男朋友或女朋友是否加入您或公共交通的便利程度。最后，假设你为感知器选择了一个5的阈值。通过这些选择，感知器实现所需的决策模型，在天气良好时输出1，而在天气不好时输出0。无论你的男朋友还是女朋友想去，或者公共交通是否在附近，输出结果都没有区别。

通过改变权重和阈值，我们可以得到不同的决策模型。例如，假设我们选择了3的阈值，那么感知器会决定在天气好的时候或节日公共交通便利时，您的男朋友或女朋友愿意加入您，您就去参加音乐节。换句话说，这将是一个不同的决策模式。降低门槛意味着你更愿意去参加这个节日。

显然，感知器不是一个完整的人类决策模型！但是，这个例子说明了感知器如何权衡不同种类的证据以作出决定。似乎有理由认为，复杂的感知器网络可能会做出相当微妙的决定：

<img alt="tikz1" src="http://neuralnetworksanddeeplearning.com/images/tikz1.png">

在这个网络中，第一列感知器 - 我们称之为第一**层**感知器 - 通过权衡输入证据，做出三个非常简单的决定。第二层感知器呢？这些感知器中的每一个都通过对第一层决策结果进行权衡来做出决定。通过这种方式，第二层中的感知器可以在比第一层中的感知器更复杂和更抽象的层次上做出决定。第三层感知器可以做出更复杂的决定。通过这种方式，感知器的多层网络可以进行复杂的决策。

顺便说一下，当我定义感知器时，我说感知器只有一个输出。在感知器之上的网络看起来他们有多个输出。事实上，他们仍然是单一输出。多个输出箭头仅仅是一个有用的方式，表明感知器的输出被用作其他几个感知器的输入。它比绘制一条单一的输出线然后分裂更简洁。

让我们简化描述感知器的方式。条件 $\sum _j w_jx_j > threshold$ 很麻烦，我们可以改变两个符号来简化它。第一个改变是将 $\sum _j w_jx_j$ 写成一个点积，$w \cdot x \equiv \sum_j w_j x_j$ ，其中 $w$ 和  $x$ 分别是权重和输入的向量。第二个变化是将 $threshold$ 移到不等式的另一端，并用所谓的感知器的**偏差** $b≡-threshold$ 来代替它。使用偏差而不是阈值，感知器规则可以被重写为：

$\begin{eqnarray}\mbox{output} = \left\{ \begin{array}{ll} 0 & \mbox{if } w\cdot x + b \leq 0 \\1 & \mbox{if } w\cdot x + b > 0\end{array}\right.\tag{2}\end{eqnarray}$

